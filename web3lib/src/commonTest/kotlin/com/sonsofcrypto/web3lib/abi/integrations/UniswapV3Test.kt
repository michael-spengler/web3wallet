package com.sonsofcrypto.web3lib.abi.integrations

import com.sonsofcrypto.web3lib.types.Address
import com.sonsofcrypto.web3lib.utils.BigInt
import com.sonsofcrypto.web3lib.utils.extensions.toHexString
import com.sonsofcrypto.web3lib.utils.setReturnValue
import kotlin.test.Test
import kotlin.test.assertEquals

class UniswapV3Test {
    @Test
    fun testUniswapMultiCall() {
        setReturnValue("04e45aaf2114920f5543345d26d17731f15bfb089b8360c4e1c69c195f2adcc6")
        val actual = UniswapV3.multicall(
            deadline = BigInt.from(1664202313),
            tokenIn = Address.HexString("0x6b175474e89094c44da98b954eedeac495271d0f"),
            tokenOut = Address.HexString("0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2"),
            fee = BigInt.from(500),
            recipient = Address.HexString("0x58aebec033a2d55e35e44e6d7b43725b069f6abc"),
            amountIn = BigInt.from(1336224203099700158),
            amountOutMinimum = BigInt.from(784971974592424),
            sqrtPriceLimitX96 = BigInt.from(0)
        )

        //actual.toHexString().chunked(64).forEach { println(it) }

        assertEquals(expectedEIS, actual.toHexString())
    }
}


/*
0x04e45aaf
0000000000000000000000006b175474e89094c44da98b954eedeac495271d0f
000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2
0000000000000000000000000000000000000000000000000000000000002710
0000000000000000000000000000000000000000000000000000000000000002
00000000000000000000000000000000000000000000000014d1120d7b160000
0000000000000000000000000000000000000000000000000003d1e32a91cabd
0000000000000000000000000000000000000000000000000000000000000000
0x49616997
0000000000000000000000000000000000000000000000000003d1e32a91cabd
*/

var expectedEIS =
    //"0x5ae401dc" +
            "000000000000000000000000000000000000000000000000000000006331b649" +
            "0000000000000000000000000000000000000000000000000000000000000001" +
            "0000000000000000000000000000000000000000000000000000000000000020" +
            "00000000000000000000000000000000000000000000000000000000000000e4" +
            "04e45aaf0000000000000000000000006b175474e89094c44da98b954eedeac4" +
            "95271d0f000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead908" +
            "3c756cc200000000000000000000000000000000000000000000000000000000" +
            "000001f400000000000000000000000058aebec033a2d55e35e44e6d7b43725b" +
            "069f6abc000000000000000000000000000000000000000000000000128b38d5" +
            "46097bbe0000000000000000000000000000000000000000000000000002c9ed" +
            "87b447a800000000000000000000000000000000000000000000000000000000" +
            "0000000000000000000000000000000000000000000000000000000000000000"



const val expectedUniswap1 =
    "04e45aaf" +
    "000000000000000000000000000000000000000000000000000000006313ceb1"+
    "0000000000000000000000000000000000000000000000000000000000000040"+
    "0000000000000000000000000000000000000000000000000000000000000002"+
    "0000000000000000000000000000000000000000000000000000000000000040"+
    "0000000000000000000000000000000000000000000000000000000000000160"+
    "00000000000000000000000000000000000000000000000000000000000000e4"+
    "04e45aaf0000000000000000000000006b175474e89094c44da98b954eedeac4"+
    "95271d0f000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead908"+
    "3c756cc200000000000000000000000000000000000000000000000000000000"+
    "000001f400000000000000000000000000000000000000000000000000000000"+
    "00000002000000000000000000000000000000000000000000000000128b38d5"+
    "46097bbe0000000000000000000000000000000000000000000000000002c9ed"+
    "87b447a800000000000000000000000000000000000000000000000000000000"+
    "0000000000000000000000000000000000000000000000000000000000000000"+
    "0000000000000000000000000000000000000000000000000000000000000044"+
    "49404b7c0000000000000000000000000000000000000000000000000002c9ed"+
    "87b447a800000000000000000000000058aebec033a2d55e35e44e6d7b43725b"+
    "069f6abc00000000000000000000000000000000000000000000000000000000"

val expectedEIS0 =
    "04e45aaf" +
    "00000000000000000000000000000000000000000000000000000000000000e0" +
    "00000000000000000000000000000000000000000000000000000000000000ff" +
    "000000000000000000000000000000000000000000000000000000000000011e" +
    "000000000000000000000000000000000000000000000000000000000000013e" +
    "000000000000000000000000000000000000000000000000000000000000015d" +
    "000000000000000000000000000000000000000000000000000000000000017d" +
    "000000000000000000000000000000000000000000000000000000000000019d" +
    "000000000000000000000079d96cda567282cec884772fb621d1f2d0e6b8d900" +
    "0000000000000000000079d96cda567282cec884772fb621d1f2d0e6b8d90000" +
    "0000000000000000000000000000000000000000000000000000000000640000" +
    "00000000000000000079d96cda567282cec884772fb621d1f2d0e6b8d9000000" +
    "0000000000000000000000000000000000000000000000000000000064000000" +
    "0000000000000000000000000000000000000000000000000000000064000000" +
    "0000000000000000000000000000000000000000000000000000000064"
